{% extends 'base.html' %}
{% load i18n %}
{% load static %}

{% block content %}
    <div class="inner-container-custom d-flex">
        <div class="search-results-container w-70 border-right-custom">
            <div class="height_topbar d-flex justify-content-between align-items-center custom-topbar border-bottom-custom">
                <div class="export-container custom-body d-flex justify-content-between align-items-center">
                    <span id="results-count">0 {% trans "résultats" %}</span>
                    <div class="d-flex align-items-center container-buttons-export">
                        <div id="export-selected" class="white-button custom-text-white-buttons" type="button">
                            <img src="{% static 'svg/icons/export.svg' %}">
                            <span>{% trans "Exporter la sélection" %}</span>
                        </div>
                        <div id="export-all" class="white-button custom-text-white-buttons" type="button">
                            <img src="{% static 'svg/icons/export.svg' %}">
                            <span>{% trans "Tout exporter" %}</span>
                        </div>

                    </div>
                </div>
            </div>
            <div id="selected-filters-container" class="selected-filters-container overflow-auto">
            </div>
            <div class="table-container">
                <table id="survey-table" class="" style="width:100%">
                    <thead class="table-dark" style="display:none">
                    <tr>
                        <th>Enquête</th>
                    </tr>
                    </thead>
                </table>
                <div class="container-button-load-more">
                    <div type="button" id="load-more" class="load-more-button white-button custom-text-white-buttons">{% trans "Charger plus" %}</div>
                </div>
            </div>
        </div>
        <div class="filters-container w-30">
            <div class="height_topbar border-bottom-custom padding-filters-container">
                <div class="custom-body color-grey-1">
                    {% trans "Filtrer par" %}
                </div>
            </div>
            <div class="accordion" id="filtersAccordion">
                <div class="accordion-item accordion-item-custom padding-filters-container" data-filter-type="search_location">
                    <div class="accordion-header" id="headingOne">
                        <div class="accordion-button collapsed custom-body color-grey-1" type="button" data-toggle="collapse" data-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
                            <div class="collapse-title">
                                <span>{% trans "Types de métadonnées" %}</span>
                                <span class="filter-count"></span>
                            </div>
                            <i class="fas fa-caret-down icon-caret"></i>
                        </div>
                    </div>
                    <div id="collapseOne" class="accordion-collapse collapse" aria-labelledby="headingOne" >
                        <div class="accordion-body">
                            <div id="search-location" class="div-all-checkboxes">
                                <div class="form-check-custom">
                                    <input class="form-check-input search-location-checkbox checkbox-custom" type="checkbox" value="questions" id="search-location-questions">
                                    <label class="form-check-label" for="search-location-questions">{% trans "Questions" %}</label>
                                </div>
                                <div class="form-check-custom">
                                    <input class="form-check-input search-location-checkbox checkbox-custom" type="checkbox" value="categories" id="search-location-categories">
                                    <label class="form-check-label" for="search-location-categories">{% trans "Modalités" %}</label>
                                </div>
                                <div class="form-check-custom">
                                    <input class="form-check-input search-location-checkbox checkbox-custom" type="checkbox" value="variable_name" id="search-location-variable_name">
                                    <label class="form-check-label" for="search-location-variable_name">{% trans "Nom de la variable" %}</label>
                                </div>
                                <div class="form-check-custom">
                                    <input class="form-check-input search-location-checkbox checkbox-custom" type="checkbox" value="internal_label" id="search-location-internal_label">
                                    <label class="form-check-label" for="search-location-internal_label">{% trans "Libellé de la variable" %}</label>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item accordion-item-custom padding-filters-container" data-filter-type="collections">
                    <div class="accordion-header" id="headingTwo">
                        <div class="accordion-button collapsed custom-body color-grey-1" type="button" data-toggle="collapse" data-target="#collapseTwo" aria-expanded="false" aria-controls="collapseTwo">
                            <div class="collapse-title">
                                <span>{% trans "Collections" %}</span>
                                <span class="filter-count"></span>
                            </div>
                            <i class="fas fa-caret-down icon-caret"></i>
                        </div>
                    </div>
                    <div id="collapseTwo" class="accordion-collapse collapse" aria-labelledby="headingTwo" >
                        <div class="accordion-body">
                            <div id="collections-filter" class="div-all-checkboxes">
                                {% for collection in collections %}
                                    <div class="form-check-custom">
                                        <input class="form-check-input collection-checkbox checkbox-custom" type="checkbox" value="{{ collection.id }}" id="collection-{{ collection.id }}" {% if collection.id|stringformat:"s" in request.session.selected_collection %}checked{% endif %}>
                                        <label class="form-check-label" for="collection-{{ collection.id }}">
                                            {{ collection.name }}
                                        </label>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item accordion-item-custom padding-filters-container" data-filter-type="sub_collections">
                    <div class="accordion-header" id="headingThree">
                        <div class="accordion-button collapsed custom-body color-grey-1" type="button" data-toggle="collapse" data-target="#collapseThree" aria-expanded="false" aria-controls="collapseThree">
                            <div class="collapse-title">
                                <span>{% trans "Sous-collections" %}</span>
                                <span class="filter-count"></span>
                            </div>
                            <i class="fas fa-caret-down icon-caret"></i>
                        </div>
                    </div>
                    <div id="collapseThree" class="accordion-collapse collapse" aria-labelledby="headingThree">
                        <div class="accordion-body">
                            <div id="subcollections-filter" class="div-all-checkboxes">
                                {% for subcollection in subcollections %}
                                    <div class="form-check-custom">
                                        <input class="form-check-input subcollection-checkbox checkbox-custom" type="checkbox" value="{{ subcollection.id }}" id="subcollection-{{ subcollection.id }}" {% if subcollection.id|stringformat:"s" in request.session.selected_sub_collection %}checked{% endif %}>
                                        <label class="form-check-label" for="subcollection-{{ subcollection.id }}">
                                            {{ subcollection.name }}
                                        </label>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item accordion-item-custom padding-filters-container" data-filter-type="survey">
                    <div class="accordion-header" id="headingFour">
                        <div class="accordion-button collapsed custom-body color-grey-1" type="button" data-toggle="collapse" data-target="#collapseFour" aria-expanded="false" aria-controls="collapseFour">
                            <div class="collapse-title">
                                <span>{% trans "Enquêtes" %}</span>
                                <span class="filter-count"></span>
                            </div>
                            <i class="fas fa-caret-down icon-caret"></i>
                        </div>
                    </div>
                    <div id="collapseFour" class="accordion-collapse collapse" aria-labelledby="headingFour" >
                        <div class="accordion-body">
                            <div id="survey-filter" class="div-all-checkboxes">
                                {% for survey in surveys %}
                                    <div class="form-check-custom">
                                        <input class="form-check-input survey-checkbox checkbox-custom" type="checkbox" value="{{ survey.id }}" id="survey-{{ survey.id }}" {% if survey.id|stringformat:"s" in request.session.selected_surveys %}checked{% endif %}>
                                        <label class="form-check-label" for="survey-{{ survey.id }}">
                                            {{ survey.name }}
                                        </label>
                                    </div>
                                {% endfor %}
                            </div>
                        </div>
                    </div>
                </div>
                <div class="accordion-item accordion-item-custom padding-filters-container" data-filter-type="years">
                    <div class="accordion-header" id="headingFive">
                        <div class="accordion-button collapsed custom-body color-grey-1" type="button" data-toggle="collapse" data-target="#collapseFive" aria-expanded="false" aria-controls="collapseFive">
                            <div class="collapse-title">
                                <span>{% trans "Années" %}</span>
                                <span class="filter-count"></span>
                            </div>
                            <i class="fas fa-caret-down icon-caret"></i>
                        </div>
                    </div>
                    <div id="collapseFive" class="accordion-collapse collapse" aria-labelledby="headingFive">
                        <div class="accordion-body" class="div-all-checkboxes">
                            <div id="years-filter">
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="reset-filters-container padding-filters-container">
                <div class="container-reset-button">
                    <div type="button" id="reset-filters" class="white-button custom-text-white-buttons">
                        <img src="{% static 'svg/icons/reset.svg' %}" class="reset-icon" alt="reset-icon">
                        <span>{% trans "Réinitialiser" %}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}

{% block extra_css %}
    <link rel="stylesheet" href="{% static 'css/search_results.css' %}">

{% endblock %}

{% block extra_js %}

    <script type="text/javascript" src="https://cdn.jsdelivr.net/momentjs/latest/moment.min.js"></script>

    <script src="{% static 'js/search_results/utils.js' %}"></script>
    <script src="{% static 'js/search_results/filters.js' %}"></script>
    <script src="{% static 'js/search_results/decades.js' %}"></script>
    <script src="{% static 'js/search_results/datatable.js' %}"></script>
    <script src="{% static 'js/search_results/events.js' %}"></script>
    <script src="{% static 'js/search_results/init.js' %}"></script>
    <script src="{% static 'js/search_results/filtersAPI.js' %}"></script>
    <script src="{% static 'js/search_results/handleFilters.js' %}"></script>
    <script src="{% static 'js/search_results/applyFiltersFromURL.js' %}"></script>

    <script>

        window.translations = {
            enquete: "{% trans 'Enquête : ' %}",
            nomVariable: "{% trans 'Nom de la variable : ' %}",
            libelleVariable: "{% trans 'Libellé de la variable : ' %}",
            modalites: "{% trans 'Modalités' %}",
            accederAuxDonnees: "{% trans 'Accéder aux données' %}",
            resultats: "{% trans ' résultats' %}",
        };

    </script>
{% endblock %}
